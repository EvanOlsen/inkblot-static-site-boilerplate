/*!
 * backgroundVideo v2.0.2
 * https://github.com/linnett/backgroundVideo
 * Use HTML5 video to create an effect like the CSS property,
 * 'background-size: cover'. Includes parallax option.
 *
 * Copyright 2016 Sam Linnett <linnettsam@gmail.com>
 * @license http://www.opensource.org/licenses/mit-license.html MIT License
 */
"use strict";!function(t,e){const i="BackgroundVideo";"function"==typeof define&&define.amd?define([],e(i)):"object"==typeof exports?module.exports=e(i):t[i]=e(i)}(window||module||{},function(t){const e={parallax:{effect:1.5},pauseVideoOnViewLoss:!1,preventContextMenu:!1,minimumVideoWidth:400,autoplayFallback:"",onBeforeReady:function(){},onReady:function(){}},i=function(t,e){t.classList?t.classList.add(e):t.className+=" "+e};class s{constructor(t,i){this.element=document.querySelectorAll(t),this.options=Object.assign({},e,i),this.options.browserPrexix=this.detectBrowser(),this.shimRequestAnimationFrame(),this.options.has3d=this.detect3d(),this.setWindowDimensions();for(let t=0;t<this.element.length;t++)this.init(this.element[t],t)}init(t,e){this.el=t,this.playEvent=this.videoReadyCallback.bind(this),this.setVideoWrap(e),this.setVideoProperties(),this.insertVideos(),this.options&&this.options.onBeforeReady()&&this.options.onBeforeReady(),this.el.readyState>3?this.videoReadyCallback():(this.el.addEventListener("canplaythrough",this.playEvent,!1),this.el.addEventListener("canplay",this.playEvent,!1)),this.options.preventContextMenu&&this.el.addEventListener("contextmenu",()=>!1)}videoReadyCallback(){this.el.removeEventListener("canplaythrough",this.playEvent,!1),this.el.removeEventListener("canplay",this.playEvent,!1),this.options.originalVideoW=this.el.videoWidth,this.options.originalVideoH=this.el.videoHeight,this.bindEvents(),this.requestTick(),this.scaleObject(),this.options&&this.options.onReady()&&this.options.onReady()}bindEvents(){this.ticking=!1,this.options.parallax&&window.addEventListener("scroll",this.requestTick.bind(this)),window.addEventListener("resize",this.requestTick.bind(this)),window.addEventListener("resize",this.setWindowDimensions.bind(this))}setWindowDimensions(){this.windowWidth=window.innerWidth,this.windowHeight=window.innerHeight}requestTick(){this.ticking||(this.ticking=!0,window.requestAnimationFrame(this.positionObject.bind(this)))}positionObject(){const t=window.pageYOffset;let{xPos:e,yPos:i}=this.scaleObject();i=this.calculateYPos(i,0);const s=this.options.has3d?`translate3d(${e}px, ${i}px, 0)`:`translate(${e}px, ${i}px)`;this.el.style[`${this.options.browserPrexix}`]=s,this.el.style.transform=s,this.ticking=!1}scaleObject(){const t=this.windowWidth/this.options.originalVideoW,e=this.windowHeight/this.options.originalVideoH;let i;this.options.bvVideoWrap.style.width=`${this.windowWidth}px`,this.options.bvVideoWrap.style.height=`${this.windowHeight}px`,(i=t>e?t:e)*this.options.originalVideoW<this.options.minimumVideoWidth&&(i=this.options.minimumVideoWidth/this.options.originalVideoW);const s=i*this.options.originalVideoW,o=i*this.options.originalVideoH;return this.el.style.width=`${s}px`,this.el.style.height=`${o}px`,{xPos:-parseInt((s-this.windowWidth)/2),yPos:parseInt(o-this.windowHeight)/2}}calculateYPos(t,e){const i=parseInt(this.options.bvVideoWrap.offsetTop),s=i;return t=-(s+t)}setVideoWrap(t){const e=document.createElement("div");this.options.bvVideoWrapClass=`${this.el.className}-wrap-${t}`,i(e,"bv-video-wrap"),i(e,this.options.bvVideoWrapClass),e.style.position="relative",e.style.overflow="hidden",e.style.zIndex="10",this.el.parentNode.insertBefore(e,this.el),e.appendChild(this.el),this.options.bvVideoWrap=document.querySelector(`.${this.options.bvVideoWrapClass}`)}setVideoProperties(){this.el.setAttribute("preload","metadata"),this.el.setAttribute("loop","true"),this.el.setAttribute("autoplay","autoplay"),this.el.style.position="absolute",this.el.style.zIndex="1";var t=this.options.autoplayFallback;t&&this.el.setAttribute("poster",t)}insertVideos(){for(let t=0;t<this.options.src.length;t++){let e=this.options.src[t].split("."),i=e[e.length-1];this.addSourceToVideo(this.options.src[t],`video/${i}`)}}addSourceToVideo(t,e){const i=document.createElement("source");i.dataset.src=t,i.type=e,this.el.appendChild(i),this.el.classList.add("b-lazy")}detectBrowser(){const t=navigator.userAgent.toLowerCase();let e;return t.indexOf("chrome")>-1||t.indexOf("safari")>-1?e="webkitTransform":t.indexOf("firefox")>-1?e="MozTransform":-1!==t.indexOf("MSIE")||t.indexOf("Trident/")>0?e="msTransform":t.indexOf("Opera")>-1&&(e="OTransform"),e}shimRequestAnimationFrame(){for(var t=0,e=["ms","moz","webkit","o"],i=0;i<e.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[e[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[i]+"CancelAnimationFrame"]||window[e[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,i){var s=(new Date).getTime(),o=Math.max(0,16-(s-t)),n=window.setTimeout(function(){e(s+o)},o);return t=s+o,n}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}detect3d(){var t=document.createElement("p"),e,i,s={WebkitTransform:"-webkit-transform",OTransform:"-o-transform",MSTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};for(e in document.body.insertBefore(t,document.body.lastChild),s)void 0!==t.style[e]&&(t.style[e]="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)",i=window.getComputedStyle(t).getPropertyValue(s[e]));return t.parentNode.removeChild(t),void 0!==i&&"none"!==i}}return s});
//# sourceMappingURL=backgroundVideo-min.js.map